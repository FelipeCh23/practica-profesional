# 🛠️ Tareas del Proyecto – Algoritmo de galerías

## 🚧 Depuración
- [x] 🟩 (Drilling Design) Solucionar error de visualización de la grilla
- [x] 🎛️ (Drilling Design) Evitar restablecer la selección del combobox de geometría tras insertar una galería
- [x] 🧱 (Drilling Design) Corregir colocación de perforaciones de **cajas** cerca del encuentro pared/techo (evitar amontonamiento)
- [x] 🛠️ (Drilling Design) Corregir colocación de perforaciones de **corona** cuando el arco es muy curvo
- [ ] 🧪 (Layout) Usar `wall_top_y` y `wall_x_left/right` para delimitar claramente paredes vs. techo en `place_cajas`

## 🎨 Interfaz Gráfica
- [x] 🧭 Agregar una **grilla** al lienzo (tamaño en m, líneas mayores, ejes)
- [x] 🖱️ Habilitar **paneo** del lienzo (arrastrar con botón central/Shift+drag)
- [ ] 🔍 Agregar **zoom** (Ctrl+rueda o botones +/−)
- [ ] 🎨 Unificar color minería para perforaciones cargadas y vacías + selector de color
- [ ]    Agregar ventanas de pasos en la parte de arriba de la interfaz.

## 🧩 Geometría & Edición
- [x] 🧲 Bloquear la **inserción de nuevas galerías** por error (toggle `lock_geom_insert`)
- [x] 🎯 Edición de **arco** (D-shaped/Horseshoe) con manillas C/R
- [x] ➕ Insertar **puntos libres** sobre el arco y arrastrarlos
- [ ] 🧵 Suavizado del arco al mover puntos (re-muestreo/reparametrización para “curva tipo cuerda”)
- [ ] 🧷 Hit-test para **ignorar clics encima** de la galería cuando `lock_geom_insert` está activado (sin mostrar error)
- [ ] 🧰 Bezier: habilitar edición con manillas p0..p3 (similar a C/R)
- [ ] Suavizado del arco al mover puntos (re-muestreo).
- [ ]  Bezier editable con manillas p0–p3.

## Código / Organización
- [ ]✨ PEP 8 (docstrings, líneas ≤79, verbos en imperativo).
- [ ] Extraer utilidades UI a ui_helpers.py (p. ej., _vbind, helpers de tabs) y mantener drilling_design.py más limpio.
## 🔄 Flujo de trabajo
- [x] 🧭 Reordenar pasos: **eje** → **diseño de galería** → **cuele** → **contracuele** → **zapateras/cajas/corona** → **auxiliares**
- [x] 🟨 Mantener **estado del combobox** en el paso de Geometría (no resetear a “Semicircular”)

## 📤 Exportación / Compatibilidad
- [x] 📦 `export_json()`: exportar `{"holes": ..., "drifts": ...}` (reemplazar `tunnels`)
- [ ] 🧼 `clear_all()`: limpiar `drift_poly` y `scene.drifts` (eliminar referencias a `tunnel_poly/tunnels`)
- [ ] 🔁 Añadir importación simple desde `layout_export.json` (opcional)

## 📑 Documentación
- [ ] ✍️ Documentar edición de arco (C/R) y edición libre con puntos, con capturas
- [ ] 📘 Explicar el toggle **lock** y cómo crear múltiples galerías sin solaparlas

## ✅ Testing
- [ ] 🧪 Tests de `place_cajas/place_corona` en límites de pared/techo
- [ ] 🧪 Tests de geometrías: rectangular/semicircular/d-shaped/horseshoe/bezier (rangos y cerramiento)
